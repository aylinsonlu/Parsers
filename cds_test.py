import pytest
from get_cds import *

test1 = [
    ("/cta/users/abircan/GTFs_release_106/Homo_sapiens.GRCh38.106.gtf","ENSG00000036828","/cta/users/abircan/Genomes_release_106/Homo_sapiens.GRCh38.dna_sm.primary_assembly.fa","ENST00000639785","ATGGCATTTTATAGCTGCTGCTGGGTCCTCTTGGCACTCACCTGGCACACCTCTGCCTACGGGCCAGACCAGCGAGCCCAAAAGAAGGGGGACATTATCCTTGGGGGGCTCTTTCCTATTCATTTTGGAGTAGCAGCTAAAGATCAAGATCTCAAATCAAGGCCGGAGTCTGTGGAATGTATCAGGTATAATTTCCGTGGGTTTCGCTGGTTACAGGCTATGATATTTGCCATAGAGGAGATAAACAGCAGCCCAGCCCTTCTTCCCAACTTGACGCTGGGATACAGGATATTTGACACTTGCAACACCGTTTCTAAGGCCTTGGAAGCCACCCTGAGTTTTGTTGCTCAAAACAAAATTGATTCTTTGAACCTTGATGAGTTCTGCAACTGCTCAGAGCACATTCCCTCTACGATTGCTGTGGTGGGAGCAACTGGCTCAGGCGTCTCCACGGCAGTGGCAAATCTGCTGGGGCTCTTCTACATTCCCCAGGTCAGTTATGCCTCCTCCAGCAGACTCCTCAGCAACAAGAATCAATTCAAGTCTTTCCTCCGAACCATCCCCAATGATGAGCACCAGGCCACTGCCATGGCAGACATCATCGAGTATTTCCGCTGGAACTGGGTGGGCACAATTGCAGCTGATGACGACTATGGGCGGCCGGGGATTGAGAAATTCCGAGAGGAAGCTGAGGAAAGGGATATCTGCATCGACTTCAGTGAACTCATCTCCCAGTACTCTGATGAGGAAGAGATCCAGCATGTGGTAGAGGTGATTCAAAATTCCACGGCCAAAGTCATCGTGGTTTTCTCCAGTGGCCCAGATCTTGAGCCCCTCATCAAGGAGATTGTCCGGCGCAATATCACGGGCAAGATCTGGCTGGCCAGCGAGGCCTGGGCCAGCTCCTCCCTGATCGCCATGCCTCAGTACTTCCACGTGGTTGGCGGCACCATTGGATTCGCTCTGAAGGCTGGGCAGATCCCAGGCTTCCGGGAATTCCTGAAGAAGGTCCATCCCAGGAAGTCTGTCCACAATGGTTTTGCCAAGGAGTTTTGGGAAGAAACATTTAACTGCCACCTCCAAGAAGGTGCAAAAGGACCTTTACCTGTGGACACCTTTCTGAGAGGTCACGAAGAAAGTGGCGACAGGTTTAGCAACAGCTCGACAGCCTTCCGACCCCTCTGTACAGGGGATGAGAACATCAGCAGTGTCGAGACCCCTTACATAGATTACACGCATTTACGGATATCCTACAATGTGTACTTAGCAGTCTACTCCATTGCCCACGCCTTGCAAGATATATATACCTGCTTACCTGGGAGAGGGCTCTTCACCAATGGCTCCTGTGCAGACATCAAGAAAGTTGAGGCGTGGCAGGTCCTGAAGCACCTACGGCATCTAAACTTTACAAACAATATGGGGGAGCAGGTGACCTTTGATGAGTGTGGTGACCTGGTGGGGAACTATTCCATCATCAACTGGCACCTCTCCCCAGAGGATGGCTCCATCGTGTTTAAGGAAGTCGGGTATTACAACGTCTATGCCAAGAAGGGAGAAAGACTCTTCATCAACGAGGAGAAAATCCTGTGGAGTGGGTTCTCCAGGGAGGTGCCCTTCTCCAACTGCAGCCGAGACTGCCTGGCAGGGACCAGGAAAGGGATCATTGAGGGGGAGCCCACCTGCTGCTTTGAGTGTGTGGAGTGTCCTGATGGGGAGTATAGTGATGAGACAGATGCCAGTGCCTGTAACAAGTGCCCAGATGACTTCTGGTCCAATGAGAACCACACCTCCTGCATTGCCAAGGAGATCGAGTTTCTGTCGTGGACGGAGCCCTTTGGGATCGCACTCACCCTCTTTGCCGTGCTGGGCATTTTCCTGACAGCCTTTGTGCTGGGTGTGTTTATCAAGTTCCGCAACACACCCATTGTCAAGGCCACCAACCGAGAGCTCTCCTACCTCCTCCTCTTCTCCCTGCTCTGCTGCTTCTCCAGCTCCCTGTTCTTCATCGGGGAGCCCCAGGACTGGACGTGCCGCCTGCGCCAGCCGGCCTTTGGCATCAGCTTCGTGCTCTGCATCTCATGCATCCTGGTGAAAACCAACCGTGTCCTCCTGGTGTTTGAGGCCAAGATCCCCACCAGCTTCCACCGCAAGTGGTGGGGGCTCAACCTGCAGTTCCTGCTGGTTTTCCTCTGCACCTTCATGCAGATTGTCATCTGTGTGATCTGGCTCTACACCGCGCCCCCGTCAAGCTACCGCAACCAGGAGCTGGAGGATGAGATCATCTTCATCACGTGCCACGAGGGCTCCCTCATGGCCCTGGGCTTCCTGATCGGCTACACCTGCCTGCTGGCTGCCATCTGCTTCTTCTTTGCCTTCAAGTCCCGGAAGCTGCCGGAGAACTTCAATGAAGCCAAGTTCATCACCTTCAGCATGCTCATCTTCTTCATCGTCTGGATCTCCTTCATTCCAGCCTATGCCAGCACCTATGGCAAGTTTGTCTCTGCCGTAGAGGTGATTGCCATCCTGGCAGCCAGCTTTGGCTTGCTGGCGTGCATCTTCTTCAACAAGATCTACATCATTCTCTTCAAGCCATCCCGCAACACCATCGAGGAGGTGCGTTGCAGCACCGCAGCTCACGCTTTCAAGGTGGCTGCCCGGGCCACGCTGCGCCGCAGCAACGTCTCCCGCAAGCGGTCCAGCAGCCTTGGAGGCTCCACGGGATCCACCCCCTCCTCCTCCATCAGCAGCAAGAGCAACAGCGAAGACCCATTCCCACAGCCCGAGAGGCAGAAGCAGCAGCAGCCGCTGGCCCTAACCCAGCAAGAGCAGCAGCAGCAGCCCCTGACCCTCCCACAGCAGCAACGATCTCAGCAGCAGCCCAGATGCAAGCAGAAGGTCATCTTTGGCAGCGGCACGGTCACCTTCTCACTGAGCTTTGATGAGCCTCAGAAGAACGCCATGGCCCACAGGAATTCTACGCACCAGAACTCCCTGGAGGCCCAGAAAAGCAGCGATACGCTGACCCGACACGAGCCATTACTCCCGCTGCAGTGCGGGGAAACGGACTTAGATCTGACCGTCCAGGAAACAGGTCTGCAAGGACCTGTGGGTGGAGACCAGCGGCCAGAGGTGGAGGACCCTGAAGAGTTGTCCCCAGCACTTGTAGTGTCCAGTTCACAGAGCTTTGTCATCAGTGGTGGAGGCAGCACTGTTACAGAAAACGTAGTGAATTCA"),
    ("/cta/users/abircan/GTFs_release_106/Mus_musculus.GRCm39.106.gtf","ENSMUSG00000023175","/cta/users/abircan/Genomes_release_106/Mus_musculus.GRCm39.dna_sm.primary_assembly.fa","ENSMUST00000067036","ATGGCGGCGGCGCTGCTGCTGGCGCTGGCCTTCACGCTCTTGAGCGGCCAAGGCGCCTGCGCGGCGGCTGGTTTCCTCAAGGCACCACTGTCGCAGGAGCGGTGGGCGGGGGGCAGCGTGGTCCTGCACTGTGAGGCTGTGGGCAGCCCCATCCCCGAGATCCAGTGGTGGTTTGAAGGGAATGCTCCAAACGACAGCTGCTCCCAGCTCTGGGATGGTGCCCGGCTGGACCGTGTTCACATCCATGCCGCCTACCGTCAGCATGCAGCCAGTTCGCTCTCTGTTGATGGGCTCACCGCAGAGGACACAGGCACTTACGAGTGCCGGGCCAGCAGTGACCCAGACCGCAACCACCTTACTCGGCCACCCAGGGTCAAGTGGGTCCGTGCCCAGGCGAGCGTGGTGGTCCTTGAACCGGGCACCATCCAAACCTCTGTCCAGGAAGTCAACTCCAAAACACAGCTTACCTGCTCTTTGAACAGCAGTGGCGTTGACATCGTTGGCCACCGCTGGATGAGAGGTGGCAAGGTACTGCAGGAGGACACTCTGCCCGACCTGCATACGAAGTACATAGTGGACGCAGATGACCGCTCTGGGGAATATTCCTGCATCTTCCTTCCTGAGCCTGTGGGCAGAAGCGAGATCAATGTGGAAGGGCCACCCAGGATCAAGGTCGGAAAGAAATCAGAGCATTCCAGTGAGGGAGAGCTTGCGAAACTGGTCTGCAAGTCCGATGCATCCTACCCTCCTATTACAGATTGGTTCTGGTTTAAGACCTCTGACACTGGGGAAGAAGAGGCAATCACCAATAGCACTGAAGCCAATGGCAAGTATGTGGTGGTATCCACGCCTGAGAAGTCACAGCTGACCATCAGCAACCTTGACGTAAATGTTGACCCTGGCACCTACGTGTGTAATGCCACCAACGCCCAGGGCACTACTCGGGAAACCATCTCACTGCGTGTGCGGAGCCGCATGGCAGCCCTCTGGCCCTTCCTAGGCATCGTGGCTGAGGTCCTGGTGTTGGTTACCATCATCTTTATCTATGAGAAGAGGCGGAAGCCAGACCAGACCCTGGACGAGGATGACCCTGGCGCCGCCCCACTGAAGGGCAGTGGAACTCACATGAATGACAAGGACAAGAATGTACGCCAGAGGAACGCCACC")
    
]

@pytest.mark.parametrize("gtf,gene,genome,transcript,expected", test1)
def test_cds(gtf,gene,genome,transcript,expected):
    cds_dict = get_all_isoform_cds(gtf,gene,genome)
    assert get_single_transcript_cds(cds_dict,transcript) == expected

